<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Заголовок страницы</title>
    <link rel="stylesheet" href="./styles/style.css">

    <meta property="og:title" content="Заголовок страницы в OG">
    <meta property="og:description" content="Описание страницы в OG">
    <meta property="og:image" content="https://example.com/image.jpg">
    <meta property="og:url" content="https://example.com/">
	
	<script type="module">
		// Import the functions you need from the SDKs you need
		import { initializeApp } from "https://www.gstatic.com/firebasejs/10.13.1/firebase-app.js";
		import { getAnalytics } from "https://www.gstatic.com/firebasejs/10.13.1/firebase-analytics.js";
		// TODO: Add SDKs for Firebase products that you want to use
		// https://firebase.google.com/docs/web/setup#available-libraries

		// Your web app's Firebase configuration
		// For Firebase JS SDK v7.20.0 and later, measurementId is optional
		const firebaseConfig = {
			apiKey: "AIzaSyCUx2VeQo33GEa-i-YHrlx-ndfGcTCmmHw",
			authDomain: "datastore-8c4e4.firebaseapp.com",
			projectId: "datastore-8c4e4",
			storageBucket: "datastore-8c4e4.appspot.com",
			messagingSenderId: "233259574459",
			appId: "1:233259574459:web:150f03bd740951a4dcb59e",
			measurementId: "G-PK0HC4HNST"
		};

		// Initialize Firebase
		const app = initializeApp(firebaseConfig);
		const analytics = getAnalytics(app);
		const auth = firebase.auth();
        	const db = firebase.firestore();
	</script>
	
  </head>
  <body>
    <header>
      <h1>Личный сайт</h1>
    </header>
    
    <main>
	    <!-- Форма регистрации -->
	    <h2>Регистрация</h2>
	    <form id="registerForm">
	      <input type="email" id="email" placeholder="Введите email" required>
	      <input type="password" id="password" placeholder="Введите пароль" required>
	      <button type="submit">Зарегистрироваться</button>
	    </form>

	    <!-- Форма входа -->
	    <h2>Вход</h2>
	    <form id="loginForm">
	      <input type="email" id="loginEmail" placeholder="Введите email" required>
	      <input type="password" id="loginPassword" placeholder="Введите пароль" required>
	      <button type="submit">Войти</button>
	    </form>
    </main>
    
    <script>
	// Регистрация нового пользователя
	document.getElementById('registerForm').addEventListener('submit', (e) => {
	    e.preventDefault();
	    const email = document.getElementById('email').value;
	    const password = document.getElementById('password').value;

	    auth.createUserWithEmailAndPassword(email, password)
		.then((userCredential) => {
		    const user = userCredential.user;
		    console.log('Пользователь зарегистрирован:', user);

		    // Добавление пользователя в Firestore
		    return db.collection('users').doc(user.uid).set({
		        email: user.email,
		        createdAt: firebase.firestore.FieldValue.serverTimestamp()
		    });
		})
		.then(() => {
		    alert('Регистрация прошла успешно!');
		})
		.catch((error) => {
		    console.error('Ошибка при регистрации:', error.message);
		});
	});

	// Вход пользователя
	document.getElementById('loginForm').addEventListener('submit', (e) => {
	    e.preventDefault();
	    const email = document.getElementById('loginEmail').value;
	    const password = document.getElementById('loginPassword').value;

	    auth.signInWithEmailAndPassword(email, password)
		.then((userCredential) => {
		    const user = userCredential.user;
		    console.log('Пользователь вошел:', user);
		    alert('Вход выполнен успешно!');
		})
		.catch((error) => {
		    console.error('Ошибка при входе:', error.message);
		});
	});
    </script>
  </body>
</html>
